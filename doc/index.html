<!doctype html>
<html>
<head>
<meta charset="utf-8">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/3.0.1/github-markdown.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.18.1/styles/default.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markdown-it-texmath@0.6.5/css/texmath.css">
<link rel="stylesheet" href="https://gitcdn.xyz/repo/goessner/mdmath/master/css/vscode-texmath.css">

</head>
<body class="markdown-body">
<h1 id="writing-a-game-2" data-line="0" class="code-line">Writing a game</h1>
<blockquote data-line="2" class="code-line">
<ul>
<li data-line="2" class="code-line"><em>Do you know how hard it is
to make a pie chart
that looks like Pacman?</em></li>
</ul>
</blockquote>
<ul>
<li data-line="6" class="code-line">What are the ingredients that we need for effective learning?
<ul>
<li data-line="7" class="code-line">Well, we need positive reinforcement</li>
<li data-line="8" class="code-line">And, we need intrinsic motivation</li>
<li data-line="9" class="code-line">Video games can provide both of these.</li>
</ul>
</li>
<li data-line="10" class="code-line">On the other side,
we have things that we can learn from writing software:
<ul>
<li data-line="12" class="code-line">We learn to solve problems</li>
<li data-line="13" class="code-line">And, often we learn about logic and mathematics</li>
</ul>
</li>
<li data-line="14" class="code-line">So it makes sense to combine all of these together by writing a game.</li>
<li data-line="15" class="code-line">The problem is that writing a game is a huge effort,
even with all of the development tools and game engines that are available.
<ul>
<li data-line="17" class="code-line">What if we tackle something more attainable
like writing just a single feature within a game?</li>
<li data-line="19" class="code-line">Do we still get all of these benefits?</li>
<li data-line="20" class="code-line"><em>I</em> think so.</li>
</ul>
</li>
<li data-line="21" class="code-line">Today, I would like to share my own experience
and show you some pretty amazing things that I've learned
and which I think you will find interesting too,
whether or not you are a programmer.</li>
</ul>
<h1 id="learning-objectives-2" data-line="26" class="code-line">Learning objectives</h1>
<ul>
<li data-line="28" class="code-line">Let's talk briefly about some of the things that we are going to learn today.
<ul>
<li data-line="29" class="code-line">I've made a checklist with 3 things on it
so that we can check them off as we go.</li>
<li data-line="31" class="code-line">The takeaways will be a little different
depending on if you are a technical person
or a non-technical person,
but regardless, there will be something for everyone.</li>
</ul>
</li>
<li data-line="35" class="code-line">First, we're going to start by using a certain type of arithmetic
called &quot;modular arithmetic&quot;.
<ul>
<li data-line="37" class="code-line">We will use it to generate a random-looking sequence of numbers for our game.</li>
<li data-line="38" class="code-line">Don't worry about the name &quot;modular arithmetic&quot;.</li>
<li data-line="39" class="code-line">It's actually something that you've already learned
way back in elementary school.</li>
<li data-line="41" class="code-line">We are going to walk through a simple example
and I will show you just how easy it is.</li>
<li data-line="43" class="code-line">If you are a programmer then you already know how this works,
so I've got another takeaway for you.</li>
<li data-line="45" class="code-line">I've got a JavaScript implementation of a seedable pseudorandom number generator
that you can use in your own game or simulation.</li>
<li data-line="47" class="code-line">The thing that I find really amazing here
is that such a simple equation
can produce such chaotic results.</li>
<li data-line="50" class="code-line">I mean, it literally just uses a multiplication and the modulo operator
to generate the next random number.</li>
<li data-line="52" class="code-line">The real secret is in how to select the right set of constants
to use.</li>
</ul>
</li>
<li data-line="54" class="code-line">The second learning objective is about taking the random numbers
that we generated
and mapping them to points on a planet.
<ul>
<li data-line="57" class="code-line">To do this, we are going to use a little trick.</li>
<li data-line="58" class="code-line">It's based on a very surprizing result in &quot;spherical geometry&quot;.</li>
<li data-line="59" class="code-line">By taking advantage of this, we will see how to map our random numbers
to different locations on the planet
such that they are distributed uniformly.</li>
</ul>
</li>
<li data-line="62" class="code-line">The third learning objective is probably my favourite.
<ul>
<li data-line="63" class="code-line">It uses something called quaternion algebra.</li>
<li data-line="64" class="code-line">We are going to use it for rotating the 3D view in our game.</li>
<li data-line="65" class="code-line">But I've got an interesting way of visualizing quaternions
in terms of how they represent 3D rotations.</li>
<li data-line="67" class="code-line">If you are not familiar with quaternions,
this will help you to understand
or at least appreciate how fascinating the math really is.</li>
<li data-line="70" class="code-line">Even if you are a programmer who has used quaternions before,
hopefully this will give you new insight into how remarkably well-suited they are
for things like this.</li>
<li data-line="73" class="code-line">If you've used the Slerp function before
then you already know how useful it is.</li>
<li data-line="75" class="code-line">But it's also a tricky function to implement.</li>
<li data-line="76" class="code-line">In fact, many years ago I spent a lot of time
trying to optimize it to make it run faster.</li>
<li data-line="78" class="code-line">It turns out that there is an alternative
which is much faster and easier to implement.</li>
<li data-line="80" class="code-line">What's remarkable about that is how well it works
considering how simple it is
compared to Slerp.</li>
</ul>
</li>
</ul>
<h1 id="premise-2" data-line="84" class="code-line">Premise</h1>
<ul>
<li data-line="86" class="code-line">Ok, this is the fun part...</li>
<li data-line="87" class="code-line">We need a premise for our game
to provide some motivation.</li>
<li data-line="89" class="code-line">The following is just an example
of a hypothetical, simulation-type game.</li>
<li data-line="91" class="code-line">It is inspired by the Mars missions
which have been in the news recently.</li>
<li data-line="93" class="code-line"><em>I don't have a name for it yet,
so please feel free to contribute any ideas you have!</em>
<ul>
<li data-line="95" class="code-line">Suppose that we want to write a multi-player web game
about exploring a Mars-like planet.</li>
<li data-line="97" class="code-line">Players can:
<ul>
<li data-line="98" class="code-line">Remotely control satellites</li>
<li data-line="99" class="code-line">Deploy rovers to the surface of the planet
for collecting samples</li>
<li data-line="101" class="code-line">Run tests on those samples
to look for signs of life</li>
<li data-line="103" class="code-line">And, then, share their results
with the community.</li>
</ul>
</li>
<li data-line="105" class="code-line">Players get credit when they contribute to discoveries.</li>
<li data-line="106" class="code-line"><em>Ah, ok, I know what some of you are thinking:</em>
<ul>
<li data-line="107" class="code-line">&quot;Where's the fire button?&quot;</li>
<li data-line="108" class="code-line">&quot;How do I shoot?&quot;</li>
<li data-line="109" class="code-line">Well, maybe that's a different game altogether..</li>
</ul>
</li>
<li data-line="110" class="code-line">Regardless, for now we are just going to consider
two small features of the game
which relate to how players
can view the surface of the planet from space.
<ul>
<li data-line="114" class="code-line">To plan their simulated expeditions,
players will use an orbiting satellite
equipped with a camera.</li>
<li data-line="117" class="code-line">Players will be able to point the camera
at a particular region and zoom in
to see the terrain in detail.</li>
<li data-line="120" class="code-line">Maybe the player is looking for a particular
outcropping of rocks
or evidence of an ancient lake bed.</li>
<li data-line="123" class="code-line">As a game developer:
<ul>
<li data-line="124" class="code-line">We need to generate the terrain itself</li>
<li data-line="125" class="code-line">And we need to simulate the view from the satellite.</li>
</ul>
</li>
<li data-line="126" class="code-line">That brings us to our feature list...</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="feature-list-2" data-line="128" class="code-line">Feature list</h1>
<ul>
<li data-line="130" class="code-line">Feature #1 is about generating
random-looking terrain on the planet.</li>
<li data-line="132" class="code-line">Feature #2 is about simulating realistic transitions
between views of the planet from the satellite.</li>
<li data-line="134" class="code-line">Let's start with feature #1: generating random terrain.</li>
<li data-line="135" class="code-line">What do we mean by &quot;random&quot;?</li>
<li data-line="136" class="code-line">Well, it turns out that &quot;random&quot; can mean different things
in different situations.</li>
<li data-line="138" class="code-line">In our situation, we want something called &quot;pseudorandom&quot;.</li>
</ul>
<h1 id="pseudorandom-2" data-line="140" class="code-line">Pseudorandom</h1>
<blockquote data-line="142" class="code-line">
<ul>
<li data-line="142" class="code-line">This is probably my favourite comic:
<ul>
<li data-line="143" class="code-line">To be fair, the code is well-commented...</li>
<li data-line="144" class="code-line">But I'd like to see at least one unit test for it...</li>
</ul>
</li>
</ul>
</blockquote>
<ul>
<li data-line="146" class="code-line">Clearly we need to qualify what we mean by &quot;random&quot;.</li>
<li data-line="147" class="code-line">Has anyone here played the game Minecraft?</li>
<li data-line="148" class="code-line">In Minecraft, each world is generated uniquely
from a <strong>seed</strong> value
that you can share with other players.</li>
<li data-line="151" class="code-line">If you use the same seed as another player,
then you both play in the same world.</li>
<li data-line="153" class="code-line">For our game, we want something similar:
<ul>
<li data-line="154" class="code-line">We want to generate the planet's terrain procedurally
based on a seed value.</li>
<li data-line="156" class="code-line">Given a seed, the terrain that we generate
must be the same in every detail.</li>
<li data-line="158" class="code-line">But we also want the terrain to look random,
meaning there should be no visible patterns.</li>
<li data-line="160" class="code-line">We call this <strong>pseudorandom</strong>: The terrain is
random-looking but perfectly reproducible
based on the initial seed.</li>
</ul>
</li>
</ul>
<h1 id="generating-random-terrain-2" data-line="164" class="code-line">Generating random terrain</h1>
<ul>
<li data-line="166" class="code-line">There are many techniques
for generating realistic terrain in a game.</li>
<li data-line="168" class="code-line">In fact that is a whole topic onto itself
and deserves its own presentation.</li>
<li data-line="170" class="code-line">Typically it involves generating terrain information
like height, slope, and colour for each location
on the planet that we're interested in.</li>
<li data-line="173" class="code-line">In order to keep this presentation within scope,
we are going to make a sweeping assumption:
<ul>
<li data-line="175" class="code-line">We are going to assume that we already know
how to generate that information
given a set of random points
on the planet.</li>
<li data-line="179" class="code-line">We won't worry about <strong>how</strong> those points are used.</li>
<li data-line="180" class="code-line">We'll just say that &quot;a suitable technique exists&quot;.</li>
<li data-line="181" class="code-line">Here is an example of what I mean...</li>
</ul>
</li>
</ul>
<h1 id="voronoi-diagram-2" data-line="183" class="code-line">Voronoi diagram</h1>
<ul>
<li data-line="185" class="code-line">A <strong>Voronoi diagram</strong> assigns the colour of each pixel
according to the nearest generator point.</li>
<li data-line="187" class="code-line">But it doesn't need to be colour.
<ul>
<li data-line="188" class="code-line">It could be terrain height,
for example,
as a function of the distance
to the nearest point.</li>
<li data-line="192" class="code-line">We could clamp that or put a lower limit on it,
and then we get a basic-looking landscape.</li>
</ul>
</li>
<li data-line="194" class="code-line">Regardless, the idea here is
that given a set of random points,
techniques do exist to generate terrain.</li>
</ul>
<h1 id="our-first-two-learning-objectives-2" data-line="198" class="code-line">Our first two learning objectives</h1>
<ul>
<li data-line="200" class="code-line">With our big assumption,
we can focus just on generating
points on the planet.</li>
<li data-line="203" class="code-line">We will take it step-by-step
so that it lines up with
our first 2 learning objectives.</li>
<li data-line="206" class="code-line">First, we need a sequence of pseudorandom numbers.
<ul>
<li data-line="207" class="code-line">This is where I'll show you just how simple
the equation is.</li>
<li data-line="209" class="code-line">But we will also gain an appreciation
for how difficult it would be
to select the constants in that equation
such that the output is sufficiently random-looking.</li>
</ul>
</li>
<li data-line="213" class="code-line">Second, we need to map those numbers
to locations on the planet.
<ul>
<li data-line="215" class="code-line">This is where I will show you
that little trick from spherical geometry.</li>
</ul>
</li>
</ul>
<h1 id="learning-objective-1-2" data-line="218" class="code-line">Learning objective #1</h1>
<ul>
<li data-line="220" class="code-line">In our game, we don't need
a cryptographically-strong generator.</li>
<li data-line="222" class="code-line">The built-in generators
provided by most programming languages
should be sufficient.</li>
<li data-line="225" class="code-line">In JavaScript, it's called <code>Math.random()</code>.</li>
<li data-line="226" class="code-line">Unfortunately <code>Math.random()</code>
provides no way to set the seed.</li>
<li data-line="228" class="code-line">If we try to use it
for generating the points on our planet
we cannot guarantee
that every player will see the same world.</li>
<li data-line="232" class="code-line">So, we need a seedable generator.</li>
<li data-line="233" class="code-line">The equation used for this
is called a linear congruential generator
or <strong>LCG</strong>:
<ul>
<li data-line="236" class="code-line">The LCG that we will use is the <strong>Lehmer</strong> type.</li>
<li data-line="237" class="code-line">It looks even simpler than other types,
but still produces amazing results.</li>
<li data-line="239" class="code-line">The arithmetic it uses is actually
something that you learned
in elementary school,
just with bigger numbers.</li>
<li data-line="243" class="code-line">It involves two constants
which need to be chosen very carefully
to ensure that the output is sufficiently random.</li>
<li data-line="246" class="code-line">We will use very small constants
for the demonstration
but the arithmetic is essentially the same.</li>
</ul>
</li>
</ul>
<h1 id="modulo-operation-2" data-line="250" class="code-line">Modulo operation</h1>
<ul>
<li data-line="252" class="code-line">The modulo operator returns the remainder of a division.</li>
<li data-line="253" class="code-line"><em>(At least this is true for the positive numbers which we care about).</em></li>
<li data-line="254" class="code-line">&quot;31 mod 10&quot; is just the remainder of dividing 31 by 10.</li>
<li data-line="255" class="code-line">So, &quot;31 mod 10&quot; is equal to 1.</li>
<li data-line="256" class="code-line">If you remember doing long division, the remainder
is what we are left with at the end.</li>
<li data-line="258" class="code-line">That remainder is exactly what the modulo operation returns.</li>
</ul>
<h1 id="generator-equation-ssubn1sub--7--ssubnsub-mod-10-2" data-line="260" class="code-line">Generator equation: s<sub>n+1</sub> = (7 * s<sub>n</sub>) mod 10</h1>
<ul>
<li data-line="262" class="code-line">The equation above is the Lehmer LCG equation using small constants:
<ul>
<li data-line="263" class="code-line">In a real generator, the constants would be much larger.</li>
<li data-line="264" class="code-line">It says: The next value is equal to 7 times the previous value,
modulo 10.</li>
<li data-line="266" class="code-line">The &quot;7&quot; is called the multiplier.</li>
<li data-line="267" class="code-line">The &quot;10&quot; is called the modulus.</li>
</ul>
</li>
<li data-line="268" class="code-line">Let's work through this example
starting with an initial seed of 1 (<em>go to edit mode</em>)...</li>
</ul>
<blockquote data-line="271" class="code-line">
<ul>
<li data-line="271" class="code-line">The sequence repeats after 4 iterations.</li>
<li data-line="272" class="code-line">We say that this sequence has a <strong>period</strong> of 4.</li>
</ul>
</blockquote>
<blockquote data-line="274" class="code-line">
<ul>
<li data-line="274" class="code-line">Also, note how the generated values
are always less than the modulus
(which in this case is 10).</li>
</ul>
</blockquote>
<h1 id="starting-from-a-different-seed-2" data-line="278" class="code-line">Starting from a different seed</h1>
<ul>
<li data-line="280" class="code-line">What happens if we start
from a different value?
<ul>
<li data-line="282" class="code-line">Let's try an initial seed of 2.</li>
<li data-line="283" class="code-line">As you can see, we get a different sequence.</li>
</ul>
</li>
<li data-line="284" class="code-line">This sequence also has a period of 4.</li>
</ul>
<blockquote data-line="286" class="code-line">
<ul>
<li data-line="286" class="code-line">You might notice that there is one number
we haven't seen yet: the number 5.</li>
</ul>
</blockquote>
<h1 id="an-example-of-a-short-period-2" data-line="289" class="code-line">An example of a short period</h1>
<ul>
<li data-line="291" class="code-line">If we start with an initial seed of 5,
we repeat forever on that value.</li>
<li data-line="293" class="code-line">This is a period of just 1.</li>
<li data-line="294" class="code-line"><em>Obviously, we want to avoid this</em>.</li>
<li data-line="295" class="code-line">We can avoid short periods like this
by choosing the constants carefully.</li>
<li data-line="297" class="code-line">In fact, there are well-defined rules
for choosing the constants
to ensure a maximal period
regardless of the initial seed.</li>
<li data-line="301" class="code-line">Unfortunately, even if we choose our constants
according to those rules,
we can still end up with undesirable patterns
in the output.</li>
<li data-line="305" class="code-line">And, to make matters worse, those patterns
might not be obvious at first glance.</li>
<li data-line="307" class="code-line">Let's do a poll to show an example.</li>
</ul>
<h1 id="now-its-time-for-our-poll-2" data-line="309" class="code-line">Now it's time for our POLL!</h1>
<ul>
<li data-line="311" class="code-line"><em>The poll is anonymous and just for fun</em>.</li>
<li data-line="312" class="code-line">Here are two LCG sequences
starting from the same seed value
and using the same modulus.</li>
<li data-line="315" class="code-line">The only thing different is the multiplier.</li>
<li data-line="316" class="code-line">I want to know: Which do you think looks more random,
sequence A or sequence B?</li>
<li data-line="318" class="code-line">(<em>conduct poll</em>)</li>
<li data-line="319" class="code-line">It turns out that one of the sequences
contains an obvious pattern
if you try to use it for plotting points.</li>
<li data-line="322" class="code-line">There is a simple test called the <strong>spectral test</strong>
which helps us to see these patterns.</li>
<li data-line="324" class="code-line">The way it works is:
<ul>
<li data-line="325" class="code-line">Each time you generate a new number,
you plot that number on the x-axis
against the previous number on the y-axis.</li>
</ul>
</li>
</ul>
<h1 id="spectral-plot-for-sequence-a-2" data-line="329" class="code-line">Spectral plot for sequence A</h1>
<ul>
<li data-line="331" class="code-line">You can start to see how the points
tend to fall on one of three parallel lines.</li>
</ul>
<h1 id="spectral-plot-for-sequence-b-2" data-line="334" class="code-line">Spectral plot for sequence B</h1>
<ul>
<li data-line="336" class="code-line">These points seem more scattered.</li>
<li data-line="337" class="code-line">Based on these plots,
we can say that sequence B is more random.</li>
<li data-line="339" class="code-line">The spectral test is not exhaustive.</li>
<li data-line="340" class="code-line">There are tests which are more sophisticated.</li>
<li data-line="341" class="code-line">Researchers have published constants
that are known to produce good results.</li>
<li data-line="343" class="code-line">We just need to find a set that is suitable
for our generator in JavaScript.</li>
</ul>
<h1 id="number-format-in-javascript-2" data-line="346" class="code-line">Number format in JavaScript</h1>
<ul>
<li data-line="348" class="code-line">Many of the recommended constants
require support for 64-bit integers.</li>
<li data-line="350" class="code-line">In JavaScript however, numbers are represented
using a floating-point format like this.</li>
<li data-line="352" class="code-line">(It's called the IEEE double-precision format).</li>
<li data-line="353" class="code-line">It only has about 52 bits of precision
since the other bits are used for the sign
and exponent.</li>
<li data-line="356" class="code-line">Fortunately there is something called
the Park-Miller random number generator.
<ul>
<li data-line="358" class="code-line">The constants suggested by Park and Miller in 1993
just happen to be suitable for JavaScript,
and should be sufficient for the purposes of our game.</li>
<li data-line="361" class="code-line">The multiplier is a 16-bit number
and the modulus is a 32-bit number.</li>
<li data-line="363" class="code-line">We already saw how the output
is always less than the modulus.</li>
<li data-line="365" class="code-line">When we multiply the 16-bit multiplier constant
by the the largest possible output of 32 bits,
the result requires at most 48 bits
(since 16 + 32 = 48).</li>
<li data-line="369" class="code-line">So we are ok, in fact we actually have
a few bits to spare.</li>
</ul>
</li>
</ul>
<h1 id="park-miller-generator-in-javascript-2" data-line="372" class="code-line">Park-Miller generator in JavaScript</h1>
<ul>
<li data-line="374" class="code-line">The multiplier is 48,271
and the modulus is 2,147,483,647.</li>
<li data-line="376" class="code-line">It uses the same, simple equation
that we saw before
just with these larger constants.</li>
<li data-line="379" class="code-line">(<em>show source code and unit tests</em>)</li>
</ul>
<h1 id="learning-objective-2-2" data-line="381" class="code-line">Learning objective #2</h1>
<ul>
<li data-line="383" class="code-line">Now that we can generate
a sequence of pseudorandom numbers,
the next step is to map them
to points on the planet.</li>
<li data-line="387" class="code-line">Since the planet in our game is just a large sphere,
we can use something called <strong>sphere point picking</strong>.</li>
<li data-line="389" class="code-line">We need to be careful
to ensure that the points are distributed
evenly over the sphere.</li>
<li data-line="392" class="code-line">If the mapping is incorrect,
we might see <strong>bunching</strong> at the poles
similar to how the lines of longitude
on a globe get closer together near the poles.</li>
</ul>
<h1 id="22bunching22-at-the-north-and-south-poles-2" data-line="397" class="code-line">&quot;Bunching&quot; at the North and South poles</h1>
<ul>
<li data-line="399" class="code-line">Here is an example of what we get
if we aren't careful.</li>
<li data-line="401" class="code-line">There is a slightly higher density of points
around the North and South poles.</li>
</ul>
<h1 id="sphere-point-picking-2" data-line="404" class="code-line">Sphere point picking</h1>
<ul>
<li data-line="406" class="code-line">There are several techniques
that will produce a uniform distribution
over the planet.</li>
<li data-line="409" class="code-line">The method shown here
uses just two pseudorandom numbers
for each point on the sphere.</li>
<li data-line="412" class="code-line">For a sphere of radius R
(<em>i.e., the radius of our planet</em>):
<ul>
<li data-line="414" class="code-line">Generate a pair of pseudorandom numbers <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>s</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">s_1,s_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>
between <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></eq>
and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></eq></li>
<li data-line="417" class="code-line">(Our JavaScript class has a function for that)</li>
<li data-line="418" class="code-line">(Also, <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">s_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>
and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">s_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>
will have uniform distributions)</li>
<li data-line="421" class="code-line">Let <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>=</mo><mo stretchy="false">(</mo><mn>2</mn><msub><mi>s</mi><mn>1</mn></msub><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">u=(2s_1-1)R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span></eq></li>
<li data-line="422" class="code-line">Let <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>=</mo><mn>2</mn><mi>π</mi><msub><mi>s</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\theta=2\pi s_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq></li>
<li data-line="423" class="code-line">Calculate the XYZ coordinates of the point
using these equations:</li>
</ul>
</li>
</ul>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi>x</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msqrt><mrow><msup><mi>R</mi><mn>2</mn></msup><mo>−</mo><msup><mi>u</mi><mn>2</mn></msup></mrow></msqrt><mi>cos</mi><mo>⁡</mo><mi>θ</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi>y</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msqrt><mrow><msup><mi>R</mi><mn>2</mn></msup><mo>−</mo><msup><mi>u</mi><mn>2</mn></msup></mrow></msqrt><mi>sin</mi><mo>⁡</mo><mi>θ</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi>z</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>u</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  x
  &amp;=
  \sqrt{R^2-u^2}\cos\theta \\
  y
  &amp;=
  \sqrt{R^2-u^2}\sin\theta \\
  z
  &amp;=
  u \\
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.944528em;vertical-align:-2.222264em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.722264em;"><span style="top:-4.722264em;"><span class="pstrut" style="height:3.062264em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3.062264em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-1.5em;"><span class="pstrut" style="height:3.062264em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.222264em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.722264em;"><span style="top:-4.722264em;"><span class="pstrut" style="height:3.062264em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0622639999999999em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.0222640000000003em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.177736em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3.062264em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0622639999999999em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.0222640000000003em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.177736em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-1.5em;"><span class="pstrut" style="height:3.062264em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.222264em;"><span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><ul>
<li data-line="440" class="code-line">Why does that third equation
look so different
than the first two?</li>
<li data-line="443" class="code-line">I remember being very puzzled by this.</li>
</ul>
<h1 id="uniform-distribution-2" data-line="445" class="code-line">Uniform distribution</h1>
<ul>
<li data-line="447" class="code-line">As you can see,
we have a uniform distribution
over the sphere.</li>
<li data-line="450" class="code-line">When you consider the third equation,
this would suggest that the <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span></span></span></span></eq>
coordinates of the points
are uniformly distributed.</li>
<li data-line="454" class="code-line">(In fact this is true for the projection
onto <strong>any</strong> line passing through the centre).</li>
<li data-line="456" class="code-line">The reason for this
is due to a rather surprizing result
for the surface area of a <strong>spherical segment</strong>:
<ul>
<li data-line="459" class="code-line">If you cut a sphere with two parallel planes,
the area of the strip between the planes
depends only on the distance between the planes
and not on where they cut the sphere.</li>
<li data-line="463" class="code-line">It might help to imagine the two planes
being perpendicular to the <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span></span></span></span></eq>
axis.</li>
<li data-line="466" class="code-line">Then imagine that you can move those planes
anywhere along the <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span></span></span></span></eq>
axis and get the same result.</li>
</ul>
</li>
</ul>
<h1 id="spherical-segment-2" data-line="470" class="code-line">Spherical segment</h1>
<ul>
<li data-line="472" class="code-line">Here on the right is the equation
for the surface area <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span></eq>
of a spherical segment.</li>
<li data-line="475" class="code-line">Note how it depends only
on the radius of the sphere, capital <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span></eq>,
and the spacing <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span></eq>
between the planes.</li>
<li data-line="479" class="code-line">It does not depend on small <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">r_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>
or small <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">r_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>
which vary according to
where they cut the sphere.</li>
</ul>
<h1 id="learning-objective-3-2" data-line="484" class="code-line">Learning objective #3</h1>
<ul>
<li data-line="486" class="code-line"><em>Finally, we get to talk about quaternions...</em></li>
<li data-line="487" class="code-line">Our third learning objective
is about rotating the camera in 3D
to get realistic transitions between views.</li>
</ul>
<h1 id="realistic-transitions-2" data-line="491" class="code-line">Realistic transitions</h1>
<ul>
<li data-line="493" class="code-line">In our game, the satellite is revolving around the planet
according to a prescribed orbit.</li>
<li data-line="495" class="code-line">The satellite is equipped with a virtual camera
which is capable of viewing a portion of the planet's surface.</li>
<li data-line="497" class="code-line">The player can view different regions of the planet
by adjusting the orientation of the satellite,
thereby rotating the camera.</li>
<li data-line="500" class="code-line">As game designers, we want the motion of the camera
to be realistic.</li>
<li data-line="502" class="code-line">We know the starting position
and we know the ending position.</li>
<li data-line="504" class="code-line">We need to determine the motion <em>in between</em>.</li>
<li data-line="505" class="code-line">Animators call this &quot;tweening&quot;.</li>
<li data-line="506" class="code-line">Programmers call it &quot;interpolation&quot;.</li>
<li data-line="507" class="code-line">Let's define exactly what we mean.</li>
</ul>
<h1 id="realistic-transitions-between-views-2" data-line="509" class="code-line">Realistic transitions between views</h1>
<ul>
<li data-line="511" class="code-line">We want a rotation which is <strong>continuous</strong>
and <strong>shortest arc</strong>:
<ul>
<li data-line="513" class="code-line">&quot;Continuous&quot; here means that the rate of rotation
should be more or less constant.
<ul>
<li data-line="515" class="code-line">It doesn't need to be perfectly steady
but it should not be jerky or discontinuous.</li>
<li data-line="517" class="code-line">It should appear natural, like you would expect
from a physical object like a satellite.</li>
</ul>
</li>
<li data-line="519" class="code-line">&quot;Shortest arc&quot; here means that the path taken
should be the short way around.
<ul>
<li data-line="521" class="code-line">This is kind of like how there are two paths
around the face of a clock.</li>
<li data-line="523" class="code-line">We always want the shorter path.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="shortest-arc-2" data-line="525" class="code-line">Shortest arc</h1>
<ul>
<li data-line="527" class="code-line">In Niagara Falls Ontario, there is this beautiful clock garden.</li>
<li data-line="528" class="code-line">I used to go there all the time when I was a kid.</li>
<li data-line="529" class="code-line">Let's imagine that you enter the clock garden
at the 3 o-clock position
over on the right.</li>
<li data-line="532" class="code-line">This is sort of like the positive x-axis on a graph.</li>
<li data-line="533" class="code-line">Now suppose that you want to walk to the 12 o'clock position
which is at the top,
sort of like the positive y-axis.</li>
<li data-line="536" class="code-line">There are 2 ways to get there
(assuming of course
that you remain on the perimeter of the garden
to avoid disturbing the lovely flowers).</li>
<li data-line="540" class="code-line">You can take the long way around
which takes you down through 6 o'clock
and back up through 9 o'clock.</li>
<li data-line="543" class="code-line">That's 270 degrees of arc.</li>
<li data-line="544" class="code-line">Or, you can take the short way
which is just 90 degrees of arc.</li>
<li data-line="546" class="code-line">In our game,
we always want the short way
because that's what the player would expect.</li>
</ul>
<h1 id="linear-interpolation-or-22lerp22-2" data-line="550" class="code-line">Linear interpolation or &quot;Lerp&quot;</h1>
<ul>
<li data-line="552" class="code-line">One of the simplest examples of interpolation
is called linear interpolation or <strong>Lerp</strong>.</li>
<li data-line="554" class="code-line">&quot;Linear&quot; is just a fancy word for &quot;straight line&quot;.</li>
<li data-line="555" class="code-line">Lerp is a function that interpolates between two values <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">f_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>
and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">f_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>
according to a given number <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span></span></span></span></eq>
between 0 and 1:</li>
</ul>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">Lerp</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>f</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>f</mi><mn>2</mn></msub><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>t</mi><mo stretchy="false">)</mo><msub><mi>f</mi><mn>1</mn></msub><mo>+</mo><mi>t</mi><msub><mi>f</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{Lerp}(f_1, f_2, t)
  &amp;=
  (1-t)f_1
  +
  tf_2 \\
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5000000000000002em;vertical-align:-0.5000000000000002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em;"><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mord mathrm">L</span><span class="mord mathrm">e</span><span class="mord mathrm">r</span><span class="mord mathrm">p</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5000000000000002em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em;"><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">t</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5000000000000002em;"><span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><ul>
<li data-line="570" class="code-line">
<p data-line="570" class="code-line">We call<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">f_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>
and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">f_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>
the <strong>endpoints</strong>.</p>
</li>
<li data-line="574" class="code-line">
<p data-line="574" class="code-line">What does the function return
when <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></eq>?</p>
<ul>
<li data-line="576" class="code-line">It returns the first value <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">f_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>.</li>
<li data-line="577" class="code-line">We can see this by writing <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></eq>
for <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span></span></span></span></eq> in the equation:</li>
</ul>
</li>
</ul>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">Lerp</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>f</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>f</mi><mn>2</mn></msub><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mn>0</mn><mo stretchy="false">)</mo><msub><mi>f</mi><mn>1</mn></msub><mo>+</mo><mn>0</mn><msub><mi>f</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>f</mi><mn>1</mn></msub><mo>+</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>f</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{Lerp}(f_1, f_2, 0)
  &amp;=
  (1-0)f_1
  +
  0f_2 \\
  &amp;=
  f_1
  +
  0 \\
  &amp;=
  f_1 \\
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.500000000000002em;vertical-align:-2.000000000000001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5000000000000004em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mord mathrm">L</span><span class="mord mathrm">e</span><span class="mord mathrm">r</span><span class="mord mathrm">p</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5000000000000004em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><ul>
<li data-line="596" class="code-line">What does the function return
when <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></eq>?
<ul>
<li data-line="598" class="code-line">It returns the second value <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">f_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>.</li>
<li data-line="599" class="code-line">We can see this by writing <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></eq>
for <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span></span></span></span></eq> in the equation:</li>
</ul>
</li>
</ul>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">Lerp</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>f</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>f</mi><mn>2</mn></msub><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><msub><mi>f</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><msub><mi>f</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>0</mn><mo>+</mo><msub><mi>f</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>f</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{Lerp}(f_1, f_2, 1)
  &amp;=
  (1-1)f_1
  +
  1f_2 \\
  &amp;=
  0
  +
  f_2 \\
  &amp;=
  f_2 \\
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.500000000000002em;vertical-align:-2.000000000000001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5000000000000004em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mord mathrm">L</span><span class="mord mathrm">e</span><span class="mord mathrm">r</span><span class="mord mathrm">p</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5000000000000004em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><ul>
<li data-line="618" class="code-line">
<p data-line="618" class="code-line">What does the function return
when <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">t=\frac{1}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></eq>?</p>
<ul>
<li data-line="621" class="code-line">It returns the sum of the endpoints
divided by 2,
which is their average value.</li>
</ul>
</li>
<li data-line="625" class="code-line">
<p data-line="625" class="code-line">Lerp is very easy to implement in code:</p>
<pre><code data-line="627" class="code-line language-javascript"><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lerp</span>(<span class="hljs-params">f1, f2, t</span>) </span>{
  <span class="hljs-keyword">return</span> (<span class="hljs-number">1</span> - t) * f1 + t * f2;
}
</div></code></pre>
</li>
<li data-line="633" class="code-line">
<p data-line="633" class="code-line">Lerp also works well with vectors.</p>
</li>
<li data-line="634" class="code-line">
<p data-line="634" class="code-line">Can anyone tell me what a vector is?</p>
</li>
</ul>
<h1 id="vectors-2" data-line="636" class="code-line">Vectors</h1>
<ul>
<li data-line="638" class="code-line">For our purposes, a vector just holds the coordinates of a point.</li>
<li data-line="639" class="code-line">The vector might represent the position of an object
in relation to some reference location,
or it might represent its velocity.</li>
<li data-line="642" class="code-line">In this diagram, the vector has an x-coordinate of 2
and a y-coordinate of 3.</li>
<li data-line="644" class="code-line">We will denote a vector
as shown here on the right.</li>
<li data-line="646" class="code-line">We use an underline to indicate
that the variable represents a vector,
and we write its components in a vertical column like this.</li>
</ul>
<h1 id="vector-lerp-2" data-line="650" class="code-line">Vector Lerp</h1>
<ul>
<li data-line="652" class="code-line">The vector form of Lerp
resembles the simple form,
but instead of just numbers
for the endpoints
it has vectors.</li>
<li data-line="657" class="code-line">It involves the same operations
as simple Lerp,
applied &quot;component-wise&quot;.</li>
</ul>
<h1 id="vector-lerp-component-wise-2" data-line="661" class="code-line">Vector Lerp (component-wise)</h1>
<ul>
<li data-line="663" class="code-line">As you can see,
the components of the result
are just simple Lerps
of the corresponding endpoint components.</li>
<li data-line="667" class="code-line">This might be fine for interpolating vectors,
but for the view transitions in our game
we need to interpolate <strong>3D rotations</strong>.</li>
<li data-line="670" class="code-line">So we need an equation that works
when the endpoints are some sort of representation
of 3D rotations.</li>
<li data-line="673" class="code-line">Does anyone know what we can use for this?</li>
<li data-line="674" class="code-line">We need something called <strong>spherical linear interpolation</strong>.</li>
</ul>
<h1 id="spherical-linear-interpolation-or-22slerp22-2" data-line="676" class="code-line">Spherical linear interpolation or &quot;Slerp&quot;</h1>
<ul>
<li data-line="678" class="code-line">Slerp is the spherical equivalent of Lerp,
but it's considerably more complicated.</li>
<li data-line="680" class="code-line">We've now got this angle <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span></eq>
that we need to worry about,
and when it is zero
we are going to run into
a possible division by zero
due to the <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>sin</mi><mo>⁡</mo><mi>θ</mi></mrow><annotation encoding="application/x-tex">\sin\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span></eq>
in the denominator.</li>
<li data-line="687" class="code-line">Let's take a brief look at it though,
and maybe we can appreciate
some of the underlying mathematics.</li>
<li data-line="690" class="code-line">When applied to 3D rotations,
Slerp produces a smooth transition
that meets all of our requirements
including constant rate
and shortest arc.</li>
<li data-line="695" class="code-line">The endpoints <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">q</mi><mn mathvariant="bold">1</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{q_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></eq>
and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">q</mi><mn mathvariant="bold">2</mn></msub></mrow><annotation encoding="application/x-tex">\mathbf{q_2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></eq>
represent the rotations
to be interpolated:
<ul>
<li data-line="699" class="code-line">There are various ways to represent 3D rotations.</li>
<li data-line="700" class="code-line">Here we are using <strong>unit quaternions</strong>
because they have several advantages
over another popular representation called <strong>Euler angles</strong>.</li>
</ul>
</li>
</ul>
<h1 id="euler-angles-2" data-line="704" class="code-line">Euler angles</h1>
<ul>
<li data-line="706" class="code-line">Euler angles are a sequence of three separate rotations.</li>
<li data-line="707" class="code-line">When you put them all together,
you get the desired rotation.</li>
<li data-line="709" class="code-line">They are fairly intuitive
especially in aviation
where they correspond directly to the heading,
pitch, and bank angles of an aircraft.</li>
<li data-line="713" class="code-line">Unfortunately there is a singularity in the equations
when 2 of the 3 axes become parallel.</li>
<li data-line="715" class="code-line">The other problem with Euler angles
is that they are difficult to interpolate
when you need a smooth transition.</li>
<li data-line="718" class="code-line">So they are not a good choice for us.</li>
</ul>
<h1 id="unit-quaternions-2" data-line="720" class="code-line">Unit quaternions</h1>
<ul>
<li data-line="722" class="code-line">A <strong>quaternion</strong> has four components (w, x, y, z)
like a 4D vector.</li>
<li data-line="724" class="code-line">A <strong>unit</strong> quaternion is a quaternion
whose length equals 1.</li>
<li data-line="726" class="code-line">Unlike Euler angles,
the unit quaternion representation
has no singularity
and interpolates very well.</li>
<li data-line="730" class="code-line">It uses a single rotation
around a single axis
rather than a composition of mutliple rotations.</li>
<li data-line="733" class="code-line">As programmers,
we need to be aware of the unit length constraint:</li>
</ul>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msup><mi>w</mi><mn>2</mn></msup><mo>+</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo>+</mo><msup><mi>z</mi><mn>2</mn></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  w^2 + x^2 + y^2 + z^2
  &amp;=
  1 \\
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.524108em;vertical-align:-0.512054em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.012054em;"><span style="top:-3.147946em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.512054em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.012054em;"><span style="top:-3.147946em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.512054em;"><span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><ul>
<li data-line="744" class="code-line">It's not really a big deal though,
because if we have a quaternion
whose length might not be equal to 1
then we just normalize it.</li>
</ul>
<h1 id="normalizing-a-quaternion-2" data-line="749" class="code-line">Normalizing a quaternion</h1>
<ul>
<li data-line="751" class="code-line">To normalize a quaternion,
we just divide each component by the length.</li>
<li data-line="753" class="code-line">The result will be a <strong>unit</strong> quaternion.</li>
</ul>
<h1 id="quaternion-double-cover-2" data-line="755" class="code-line">Quaternion double cover</h1>
<ul>
<li data-line="757" class="code-line">This is where is starts to get really interesting.</li>
<li data-line="758" class="code-line">The unit quaternions +q and -q
represent the same rotation.</li>
<li data-line="760" class="code-line">So, any given 3D rotation
corresponds to exactly 2 unit quaternions.</li>
<li data-line="762" class="code-line">Sometimes it helps to think of them
as the &quot;square roots&quot; of a rotation...
<ul>
<li data-line="764" class="code-line">The number 9 has two square roots: +3 and -3.</li>
<li data-line="765" class="code-line">And a rotation has two quaternions
that represent it: +q and -q.</li>
</ul>
</li>
</ul>
<h1 id="half-the-rotation-angle-2" data-line="768" class="code-line">Half the rotation angle</h1>
<ul>
<li data-line="770" class="code-line">Consider a counter-clockwise rotation
in the XY plane
of angle <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">ϕ</span></span></span></span></eq>
sort of like our little walk
around the clock garden
in Niagara Falls.
<ul>
<li data-line="776" class="code-line">In this diagram, the dot represents
where you are.</li>
<li data-line="778" class="code-line">You started at the positive x-axis
(3 o'clock)
and now you are moving counter-clockwise
toward the 12 o'clock position.</li>
<li data-line="782" class="code-line">So far, you have travelled an angle <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">ϕ</span></span></span></span></eq>.</li>
<li data-line="783" class="code-line">The unit quaternions <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">+q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord">+</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span></eq>
and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">-q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord">−</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span></eq>
that represent your rotation
form a bisector.</li>
<li data-line="787" class="code-line">You can see how +q bisects the short arc,
and -q bisects the long arc.</li>
<li data-line="789" class="code-line">Both +q and -q represent the same rotation
and we can choose the one
that leads us to the target
via the shorter path.</li>
</ul>
</li>
<li data-line="793" class="code-line">I had been using quaternions for a long time
before I realized this.</li>
<li data-line="795" class="code-line">Hopefully this helps you understand them too.</li>
<li data-line="796" class="code-line">This also helped me to understand
why the components of a unit quaternion
are in terms of <strong>half</strong> the rotation angle.
<ul>
<li data-line="799" class="code-line">You can see the example here
where the w-component is equal to <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>cos</mi><mo>⁡</mo><mfrac><mi>ϕ</mi><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\cos\frac{\phi}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.277216em;vertical-align:-0.345em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322159999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">ϕ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></eq>
and the z-component is equal to <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>sin</mi><mo>⁡</mo><mfrac><mi>ϕ</mi><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\sin\frac{\phi}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.277216em;vertical-align:-0.345em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322159999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">ϕ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></eq>.</li>
</ul>
</li>
</ul>
<h1 id="implementing-slerp-2" data-line="803" class="code-line">Implementing Slerp</h1>
<ul>
<li data-line="805" class="code-line">Implementing Slerp is not easy.</li>
<li data-line="806" class="code-line">We need to:
<ul>
<li data-line="807" class="code-line">Negate one endpoint if needed to guarantee a &quot;shortest arc&quot; rotation.</li>
<li data-line="808" class="code-line">Calculate the angle <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span></eq>
between <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">q_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>
and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">q_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>.</li>
<li data-line="811" class="code-line">Be careful to avoid a domain error
in the inverse cosine function.</li>
</ul>
</li>
<li data-line="813" class="code-line">Also, when <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\theta=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></eq> or is very small,
we need to switch to an alternative equation
to prevent a division-by-zero.</li>
<li data-line="816" class="code-line">Is there an easier (and faster) way
that still meets our requirements?</li>
<li data-line="818" class="code-line">Well, YES, of course there is!</li>
</ul>
<h1 id="an-approximation-2" data-line="820" class="code-line">An approximation</h1>
<ul>
<li data-line="822" class="code-line">If we simply Lerp the quaternions
we actually get a descent
approximation of Slerp
without the need to calculate <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span></eq>
and without the division-by-zero problem.</li>
<li data-line="827" class="code-line">Just two things here:
<ol>
<li data-line="828" class="code-line">As with Slerp,
we need to negate one of the endpoints
if their dot product is negative
to ensure a &quot;shortest arc&quot; rotation.</li>
<li data-line="832" class="code-line">We must normalize the result of the Lerp
to ensure that we return a <strong>unit</strong> quaternion.</li>
</ol>
</li>
<li data-line="834" class="code-line">These are both straightforward
and relatively simple
compared to Slerp.</li>
<li data-line="837" class="code-line">Let's call it
&quot;normalized linear interpolation&quot;:</li>
</ul>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">Nlerp</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi mathvariant="bold">q</mi><mn mathvariant="bold">1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">q</mi><mn mathvariant="bold">2</mn></msub><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="normal">normalize</mi><mo>⁡</mo><mrow><mo fence="true">{</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>t</mi><mo stretchy="false">)</mo><msub><mi mathvariant="bold">q</mi><mn mathvariant="bold">1</mn></msub><mo>+</mo><mi>t</mi><msub><mi mathvariant="bold">q</mi><mn mathvariant="bold">2</mn></msub><mo fence="true">}</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \operatorname{Nlerp}(\mathbf{q_1}, \mathbf{q_2}, t)
  &amp;=
  \operatorname{normalize}
  \left\{
  (1-t)\mathbf{q_1}
  +
  t\mathbf{q_2}
  \right\} \\
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5000000000000002em;vertical-align:-0.5000000000000002em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em;"><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mord mathrm">N</span><span class="mord mathrm">l</span><span class="mord mathrm">e</span><span class="mord mathrm">r</span><span class="mord mathrm">p</span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5000000000000002em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em;"><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mop"><span class="mord mathrm">n</span><span class="mord mathrm">o</span><span class="mord mathrm">r</span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">l</span><span class="mord mathrm">i</span><span class="mord mathrm">z</span><span class="mord mathrm">e</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">{</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">t</span><span class="mord"><span class="mord"><span class="mord mathbf">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">}</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5000000000000002em;"><span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><ul>
<li data-line="853" class="code-line">How good is the approximation?</li>
<li data-line="854" class="code-line">Well, when I first saw how good it was
it really blew my mind.</li>
<li data-line="856" class="code-line">I mean, we are basically drawing a straight line
between the two endpoints in 4-dimensional space,
and this somehow gives us a result
that is nearly as good as Slerp!</li>
<li data-line="860" class="code-line">I think that this is a real testament
to how unit quaternions
are remarkably well-suited for representing 3D rotations.</li>
</ul>
<h1 id="rotation-comparison-2" data-line="864" class="code-line">Rotation comparison</h1>
<ul>
<li data-line="866" class="code-line">Here we go.</li>
<li data-line="867" class="code-line">The green line is the Slerp result
and the red line is the Lerp result.</li>
<li data-line="869" class="code-line">How crazy is that.</li>
<li data-line="870" class="code-line">As far as I'm concerned,
unless there is a really good reason NOT to use it,
I would strongly recommend Nlerp over Slerp any day.</li>
</ul>
<h1 id="what-have-we-learned-2" data-line="874" class="code-line">What have we learned?</h1>
<ul>
<li data-line="876" class="code-line">We have achieved our 3 learning objectives
by walking through the mathematics
that we might encounter
while trying to implement 2 features in a game.</li>
</ul>
<h1 id="conclusion-2" data-line="881" class="code-line">Conclusion</h1>
<ul>
<li data-line="883" class="code-line">Maybe not everyone would agree that math is fun,
but for me it's one of the more enjoyable aspects
of programming.</li>
<li data-line="886" class="code-line">Video games can provide the motivation needed
to learn new things,
but developing a complete game is a huge effort.</li>
<li data-line="889" class="code-line">Focusing on just a small feature is more attainable
and you can still learn some very interesting things
along the way.
<ul>
<li data-line="892" class="code-line">Even if you use an existing pseudorandom number generator,
be aware that poorly-chosen constants
can cause undesirable patterns
which are not obvious at first glance.</li>
<li data-line="896" class="code-line">Tests exist for detecting this.</li>
<li data-line="897" class="code-line">Since the generator in JavaScript does not let you set the seed,
you may want to use the source code shown here
if you need a seedable generator.</li>
<li data-line="900" class="code-line">Unit quaternions are easier to understand
when you can visualize how +q and -q form a bisector
in the plane of rotation.</li>
<li data-line="903" class="code-line">(<em>remember the clock garden</em>)</li>
<li data-line="904" class="code-line">Normalized linear interpolation
is a good approximation to Slerp and is remarkably simple.</li>
<li data-line="906" class="code-line">This also makes Nlerp faster and easier to maintain.</li>
</ul>
</li>
</ul>
<h1 id="image-credits-still-needs-to-be-cleaned-up-2" data-line="908" class="code-line">Image credits (still needs to be cleaned-up)</h1>
<blockquote data-line="910" class="code-line">
<p data-line="910" class="code-line"><a href="./intro.html" data-href="./intro.html">Intro</a></p>
</blockquote>
<blockquote data-line="912" class="code-line">
<p data-line="912" class="code-line"><a href="./takeaway-all.html" data-href="./takeaway-all.html">Learning objectives</a></p>
</blockquote>
<blockquote data-line="914" class="code-line">
<p data-line="914" class="code-line"><a href="./premise.html" data-href="./premise.html">Premise</a></p>
</blockquote>
<blockquote data-line="916" class="code-line">
<p data-line="916" class="code-line"><a href="./random-number.html" data-href="./random-number.html">Random number</a></p>
</blockquote>
<blockquote data-line="918" class="code-line">
<p data-line="918" class="code-line"><a href="./perlin.html" data-href="./perlin.html">Terrain height</a></p>
</blockquote>
<blockquote data-line="920" class="code-line">
<p data-line="920" class="code-line"><a href="./voronoi.html" data-href="./voronoi.html">Voronoi diagram</a></p>
</blockquote>
<blockquote data-line="922" class="code-line">
<p data-line="922" class="code-line"><a href="./takeaway-1.html" data-href="./takeaway-1.html">Learning objective 1</a></p>
</blockquote>
<blockquote data-line="924" class="code-line">
<p data-line="924" class="code-line"><a href="./modulo.html" data-href="./modulo.html">modular arithmetic</a></p>
</blockquote>
<blockquote data-line="926" class="code-line">
<p data-line="926" class="code-line"><a href="./lcg.html" data-href="./lcg.html">simple generator (or &quot;LCG&quot;)</a></p>
</blockquote>
<blockquote data-line="928" class="code-line">
<p data-line="928" class="code-line"><a href="./floating-point.html" data-href="./floating-point.html">built-in number type</a></p>
</blockquote>
<blockquote data-line="930" class="code-line">
<p data-line="930" class="code-line"><a href="./takeaway-2.html" data-href="./takeaway-2.html">Learning objective 2</a></p>
</blockquote>
<blockquote data-line="932" class="code-line">
<p data-line="932" class="code-line"><a href="./sphere-bunched.html" data-href="./sphere-bunched.html">bunching</a></p>
</blockquote>
<blockquote data-line="934" class="code-line">
<p data-line="934" class="code-line"><a href="./sphere-uniform.html" data-href="./sphere-uniform.html">this</a></p>
</blockquote>
<blockquote data-line="936" class="code-line">
<p data-line="936" class="code-line"><a href="./spherical-segment.html" data-href="./spherical-segment.html">spherical segment</a></p>
</blockquote>
<blockquote data-line="938" class="code-line">
<p data-line="938" class="code-line"><a href="./takeaway-3.html" data-href="./takeaway-3.html">Learning objective 3</a></p>
</blockquote>
<blockquote data-line="940" class="code-line">
<p data-line="940" class="code-line"><a href="./orbiting-satellite.html" data-href="./orbiting-satellite.html">Orbiting satellite</a></p>
</blockquote>
<blockquote data-line="942" class="code-line">
<p data-line="942" class="code-line"><a href="./clock-face.html" data-href="./clock-face.html">the face of a clock</a></p>
</blockquote>
<blockquote data-line="944" class="code-line">
<p data-line="944" class="code-line"><a href="./vector.html" data-href="./vector.html">vectors</a></p>
</blockquote>
<blockquote data-line="946" class="code-line">
<p data-line="946" class="code-line"><a href="./euler.html" data-href="./euler.html">Euler angles</a></p>
</blockquote>
<blockquote data-line="948" class="code-line">
<p data-line="948" class="code-line"><a href="./double-cover.html" data-href="./double-cover.html"><strong>square roots</strong> of a rotation</a></p>
</blockquote>
<blockquote data-line="950" class="code-line">
<p data-line="950" class="code-line"><a href="./easy.html" data-href="./easy.html">Easy button!</a></p>
</blockquote>
<blockquote data-line="952" class="code-line">
<p data-line="952" class="code-line"><a href="./nlerp-versus-slerp.html" data-href="./nlerp-versus-slerp.html">compare</a></p>
</blockquote>
<h1 id="references-2" data-line="954" class="code-line">References</h1>
<ol>
<li data-line="956" class="code-line">Blow, Jonathan (January 17, 2004). <a href="http://number-none.com/product/Hacking%20Quaternions/" data-href="http://number-none.com/product/Hacking%20Quaternions/">&quot;Hacking Quaternions&quot;</a>.</li>
<li data-line="957" class="code-line">Blow, Jonathan (February 26, 2004). <a href="http://number-none.com/product/Understanding%20Slerp,%20Then%20Not%20Using%20It" data-href="http://number-none.com/product/Understanding%20Slerp,%20Then%20Not%20Using%20It">&quot;Understanding Slerp, Then Not Using It&quot;</a>.</li>
<li data-line="958" class="code-line">Evans, Barry (August 7, 2014). <a href="https://www.northcoastjournal.com/humboldt/the-mapmakers-dilemma/Content?oid=2694622" data-href="https://www.northcoastjournal.com/humboldt/the-mapmakers-dilemma/Content?oid=2694622">&quot;The Mapmaker's Dilemma.&quot;</a> From the <a href="https://www.northcoastjournal.com/" data-href="https://www.northcoastjournal.com/"><em>North Coast Journal of Politics, People &amp; Art</em></a>.</li>
<li data-line="959" class="code-line">Marsaglia, G. &quot;Choosing a Point from the Surface of a Sphere.&quot; <em>Ann. Math. Stat.</em> <strong>43</strong>, 645-646, 1972.</li>
<li data-line="960" class="code-line"><a href="https://developer.mozilla.org/en-US/" data-href="https://developer.mozilla.org/en-US/">MDN Web Docs</a></li>
<li data-line="961" class="code-line">Park, Stephen K.; Miller, Keith W. (October 1988). <a href="http://www.firstpr.com.au/dsp/rand31/p1192-park.pdf" data-href="http://www.firstpr.com.au/dsp/rand31/p1192-park.pdf">&quot;Random Number Generators: Good Ones Are Hard To Find&quot;</a> (PDF). <em>Communications of the ACM</em>. <strong>31</strong> (10): 1192–1201.</li>
<li data-line="962" class="code-line">Ronja (September 29, 2018). <a href="https://www.ronja-tutorials.com/post/028-voronoi-noise/" data-href="https://www.ronja-tutorials.com/post/028-voronoi-noise/">&quot;Voronoi Noise&quot;</a>.</li>
<li data-line="963" class="code-line">Shoemake, Ken. <a href="https://www.cs.cmu.edu/~kiranb/animation/p245-shoemake.pdf" data-href="https://www.cs.cmu.edu/~kiranb/animation/p245-shoemake.pdf">&quot;Animating Rotation with Quaternion Curves&quot;</a> (PDF). <a href="https://en.wikipedia.org/wiki/SIGGRAPH" data-href="https://en.wikipedia.org/wiki/SIGGRAPH">SIGGRAPH</a> 1985.</li>
<li data-line="964" class="code-line">Simon, Cory (February 27, 2015). <a href="http://corysimon.github.io/articles/uniformdistn-on-sphere/" data-href="http://corysimon.github.io/articles/uniformdistn-on-sphere/">&quot;Generating uniformly distributed numbers on a sphere&quot;</a>.</li>
<li data-line="965" class="code-line">Weisstein, Eric W. &quot;Sphere Point Picking.&quot; From <a href="https://mathworld.wolfram.com/" data-href="https://mathworld.wolfram.com/"><em>MathWorld</em></a>--A Wolfram Web Resource. <a href="https://mathworld.wolfram.com/SpherePointPicking.html" data-href="https://mathworld.wolfram.com/SpherePointPicking.html">https://mathworld.wolfram.com/SpherePointPicking.html</a></li>
<li data-line="966" class="code-line">Weisstein, Eric W. &quot;Spherical Segment.&quot; From <a href="https://mathworld.wolfram.com/" data-href="https://mathworld.wolfram.com/"><em>MathWorld</em></a>--A Wolfram Web Resource. <a href="https://mathworld.wolfram.com/SphericalSegment.html" data-href="https://mathworld.wolfram.com/SphericalSegment.html">https://mathworld.wolfram.com/SphericalSegment.html</a></li>
<li data-line="967" class="code-line">Weisstein, Eric W. &quot;Zone.&quot; From <a href="https://mathworld.wolfram.com/" data-href="https://mathworld.wolfram.com/"><em>MathWorld</em></a>--A Wolfram Web Resource. <a href="https://mathworld.wolfram.com/Zone.html" data-href="https://mathworld.wolfram.com/Zone.html">https://mathworld.wolfram.com/Zone.html</a></li>
<li data-line="968" class="code-line">Wikipedia contributors. &quot;Diehard tests.&quot; <em>Wikipedia, The Free Encyclopedia</em>. Wikipedia, The Free Encyclopedia, 5 Feb. 2021.</li>
<li data-line="969" class="code-line">Wikipedia contributors. &quot;Double-precision floating-point format.&quot; <em>Wikipedia, The Free Encyclopedia</em>. Wikipedia, The Free Encyclopedia, 9 Feb. 2021.</li>
<li data-line="970" class="code-line">Wikipedia contributors. &quot;Euclidean vector.&quot; <em>Wikipedia, The Free Encyclopedia</em>. Wikipedia, The Free Encyclopedia, 9 Feb. 2021.</li>
<li data-line="971" class="code-line">Wikipedia contributors. &quot;Euler angles.&quot; <em>Wikipedia, The Free Encyclopedia</em>. Wikipedia, The Free Encyclopedia, 18 Feb. 2021.</li>
<li data-line="972" class="code-line">Wikipedia contributors. &quot;George Marsaglia.&quot; <em>Wikipedia, The Free Encyclopedia</em>. Wikipedia, The Free Encyclopedia, 24 Jan. 2021.</li>
<li data-line="973" class="code-line">Wikipedia contributors. &quot;IEEE 754.&quot; <em>Wikipedia, The Free Encyclopedia</em>. Wikipedia, The Free Encyclopedia, 15 Feb. 2021.</li>
<li data-line="974" class="code-line">Wikipedia contributors. &quot;Lehmer random number generator.&quot; <em>Wikipedia, The Free Encyclopedia</em>. Wikipedia, The Free Encyclopedia, 13 Jan. 2021.</li>
<li data-line="975" class="code-line">Wikipedia contributors. &quot;Linear congruential generator.&quot; <em>Wikipedia, The Free Encyclopedia</em>. Wikipedia, The Free Encyclopedia, 22 Jan. 2021.</li>
<li data-line="976" class="code-line">Wikipedia contributors. &quot;Linear interpolation.&quot; <em>Wikipedia, The Free Encyclopedia</em>. Wikipedia, The Free Encyclopedia, 2 Feb. 2021.</li>
<li data-line="977" class="code-line">Wikipedia contributors. &quot;Modulo operation.&quot; <em>Wikipedia, The Free Encyclopedia</em>. Wikipedia, The Free Encyclopedia, 25 Feb. 2021.</li>
<li data-line="978" class="code-line">Wikipedia contributors. &quot;Perlin noise.&quot; <em>Wikipedia, The Free Encyclopedia</em>. Wikipedia, The Free Encyclopedia, 7 Feb. 2021.</li>
<li data-line="979" class="code-line">Wikipedia contributors. &quot;Quaternions and spatial rotation.&quot; <em>Wikipedia, The Free Encyclopedia</em>. Wikipedia, The Free Encyclopedia, 14 Feb. 2021.</li>
<li data-line="980" class="code-line">Wikipedia contributors. &quot;Slerp.&quot; <em>Wikipedia, The Free Encyclopedia</em>. Wikipedia, The Free Encyclopedia, 12 Feb. 2021.</li>
<li data-line="981" class="code-line">Wikipedia contributors. &quot;Spherical segment.&quot; <em>Wikipedia, The Free Encyclopedia</em>. Wikipedia, The Free Encyclopedia, 28 Apr. 2020.</li>
<li data-line="982" class="code-line">Wikipedia contributors. &quot;Voronoi diagram.&quot; <em>Wikipedia, The Free Encyclopedia</em>. Wikipedia, The Free Encyclopedia, 23 Feb. 2021.</li>
</ol>

</body></html>